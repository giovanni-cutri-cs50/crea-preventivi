<html>
  <head>
    <title>Creatore Preventivi</title>
    <meta charset="UTF-8" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
  </head>

  <body>

    <form id="dynamicForm">
       <div id="dynamicTextBoxContainer">
  <div class="form-group">
    <label for="NomeCognome">Nome e Cognome</label>
    <input class="form-control" id="NomeCognome">
  </div>
  <div class="form-group">
    <label for="Lavoro1">Lavoro 1</label>
    <input class="form-control" id="Lavoro1">
  </div>
         </div>
      <button type="button" class="btn btn-primary mt-3" onclick="addNewTextBox()">Aggiungi un altro lavoro</button>
</form>




    
    <button id="generate" onclick="generate()">Crea Preventivo</button>
    <script src="https://cdn.jsdelivr.net/npm/docx@8.5.0/build/index.umd.min.js"></script>
    <script>

      var counter = 1; // Counter to track the number of textboxes

    function addNewTextBox() {
      counter++;
      var newTextBoxDiv = document.createElement('div');
      newTextBoxDiv.classList.add('form-group');
      newTextBoxDiv.innerHTML = `
        <label for="nomeCognome${counter}">Lavoro ${counter}</label>
        <input type="text" class="form-control" id="Lavoro${counter}" name="Lavoro[]">
      `;
      document.getElementById('dynamicTextBoxContainer').appendChild(newTextBoxDiv);
    }

      function generate() {
      // Use the global variable or function provided by the library
      const { Document, Packer, Paragraph, TextRun } = window.docx;
  
      // Create a new document
      const doc = new Document({
    sections: [
        {
            properties: {},
            children: [
                new Paragraph({
                    children: [
                        new TextRun("Hello World"),
                        new TextRun({
                            text: "Foo Bar",
                            bold: true,
                        }),
                        new TextRun({
                            text: "\tGithub is the best",
                            bold: true,
                        }),
                    ],
                }),
            ],
        },
    ],
});

Packer.toBlob(doc).then(blob => {
  // Create a blob with the document content
  const url = URL.createObjectURL(blob);

  // Create a link element
  const a = document.createElement('a');
  a.href = url;
  a.download = 'My Document.docx';

  // Append the link to the body
  document.body.appendChild(a);

  // Programmatically click the link to trigger the download
  a.click();

  // Remove the link from the DOM
  document.body.removeChild(a);

  // Clean up the URL object
  URL.revokeObjectURL(url);
}).catch(error => {
  console.error('Error creating document:', error);
});

      }
    </script>


  </body>
</html>
